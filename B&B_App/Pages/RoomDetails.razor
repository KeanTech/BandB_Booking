@page "/roomdetails"
@page "/roomdetails/{roomId:int}"
@inject IRoomService<Room> roomService
@inject ILocationService<Location> locationService

<MudCard Class="indigo lighten-5">
    <MudCardHeader>
        <MudText>Rum detalje</MudText>
        <MudRating SelectedValue="@Convert.ToInt16(_room.Rating)" ReadOnly="true">
        </MudRating>
    </MudCardHeader>
    <MudCardContent>

        <MudText>
            Rum Nr.: @_room.Number
        </MudText>
        <MudText>
            Pris per nat: @_room.PricePerNight kr.
        </MudText>
        <MudText>
            Antal senge: @_room.NumberOfBeds
        </MudText>

    </MudCardContent>

    <MudCardContent>
        <MudGrid>
            @foreach (var item in pictures)
            {
                <MudItem xs="3">
                    <MudPaper Class="d-flex align-center justify-center mud-width-full py-8 indigo darken-5"><MudImage Src="@item" Height="250" Width="300"></MudImage></MudPaper>
                </MudItem>
            }
        </MudGrid>
    </MudCardContent>
</MudCard>

<MudCard Class="indigo lighten-5">
    <MudCardHeader>
        <MudText>Info om stedet</MudText>
        <MudDivider DividerType="DividerType.Middle"></MudDivider>
        <MudRating SelectedValue="@Convert.ToInt16(_location.Rating)" ReadOnly="true">

        </MudRating>

    </MudCardHeader>
    <MudCardContent>

        <MudText>
            Navn: @_location.Name
        </MudText>
        <MudText>
            Område: @_location.Area
        </MudText>
        <MudText>
            By: @_location.City
        </MudText>
        <MudText>
            Adresse: @_location.Address
        </MudText>
        <MudText>
            Postnr.: @_location.ZipCode
        </MudText>
        <MudText>
            Land: @_location.Country
        </MudText>
        <MudText>
            Antal værelser: @_location.AmountOfRooms
        </MudText>

    </MudCardContent>
    <MudDivider DividerType="DividerType.Middle" Light="false"></MudDivider>
    <MudCardContent>
        <MudGrid>
            @foreach (var item in pictures)
            {
                <MudItem xs="3">
                    <MudPaper Class="d-flex align-center justify-center mud-width-full py-8 indigo darken-5"><MudImage Src="@item" Height="250" Width="300"></MudImage></MudPaper>
                </MudItem>
            }
        </MudGrid>
    </MudCardContent>
</MudCard>

@code {
    // Used as a roomId to pass in the url
    [Parameter]
    public int? roomId { get; set; }

    private Room? _room;
    private Location? _location;
    private List<string> pictures = new List<string>() { "images/vær1.jpg", "images/vær2.jpg", "images/vær3.jpg" };


    protected override async Task OnInitializedAsync()
    {
        if (roomId == null)
            return;

        // Get room from service
        // Use roomId to get the selected room
        if (roomId != null)
            _room = await roomService.Get(roomId.Value);
        // Get location for the room
        _location = await locationService.Get(_room.LocationId);

        base.OnInitialized();
    }

}
